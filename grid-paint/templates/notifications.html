{% extends "base-adv.html" %}


{% block content %}
<div style="min-height:610px;">

<div class="container">

<h2>Notifications</h2>


<div class="image-details-comments">
	{% for n in notifications %}
	  {% if n.type == 'comment' %}
	  	<div class="pull-left" id="icon-{{ n.key }}" style="margin-right: 10px; height:60px;">
			<img src="/img/comment-icon.png" />
		</div>							
		<div class="comment" id="row-{{ n.key }}" style="margin-left:42px;">
			<div class="comment-header">
				<div class="pull-right">
		  			<a href="#" notification_id="{{ n.key }}" class="btn-delete-notification" title="Delete notification"><i class="icon icon-remove"></i></a>
			  	</div>
			  	<div>{{ n.date }}</div>
			  	<div><b>{{n.comment.author.nickname}}</b> left a comment</div>
			  	{% if not n.artwork  or not n.comment %}
			  	<div>Image or comment was deleted</div>
		  		{% else %}	
				<h2><a href="/images/details/{{ n.artwork.key.id }}#comment-{{ n.comment.key }}">{{ n.artwork.name }}</a></h2>
				{% endif %}
			</div>
			{% if n.comment %}
				{% if n.comment.hidden %}
					<div class="comment-text" style="color:red;">Hidden by administrator</div>
				{% else %}
					{% for t in n.comment.text %}
					  <div class="comment-text">{{t}}</div>
					{% endfor %}
				{% endif %}
			{% endif %}
		</div>
	  {% endif %}
	  {% if n.type == 'complain' %}
	  	<div class="pull-left" id="icon-{{ n.key }}" style="margin-right: 10px; height:60px;">
			<img src="/img/exclamation-circle-red-64.png" width="32" height="32" />
		</div>							
		<div class="comment" id="row-{{ n.key }}" style="margin-left:42px;">
			<div class="comment-header">
				<div class="pull-right">
		  			<a href="#" notification_id="{{ n.key }}" class="btn-delete-notification" title="Delete notification"><i class="icon icon-remove"></i></a>
			  	</div>
			  	<div>{{ n.date }}</div>
			  	<div><b>{{n.comment.author.nickname}}</b> complained on comment</div>
			  	{% if not n.artwork  or not n.comment %}
			  	<div>Image or comment was deleted</div>
		  		{% else %}	
				<h2><a href="/images/details/{{ n.artwork.key.id }}#comment-{{ n.comment.key }}">{{ n.artwork.name }}</a></h2>
				{% endif %}
			</div>
			{% if n.comment %}
				{% if n.comment.hidden %}
					<div class="comment-text" style="color:red;">Hidden by administrator</div>
				{% else %}
					{% for t in n.comment.text %}
					  <div class="comment-text">{{t}}</div>
					{% endfor %}
				{% endif %}
			{% endif %}
		</div>
	  {% endif %}
	  {% if n.type == 'favorite' %}
		<div class="pull-left" id="icon-{{ n.key }}" style="margin-right: 10px; height:60px;">
			<img src="/img/stars/star4.png" />
		</div>
		<div class="comment" id="row-{{ n.key }}" style="margin-left:42px;">
			<div class="comment-header">
				<div class="pull-right">
		  			<a href="#" notification_id="{{ n.key }}" class="btn-delete-notification" title="Delete notification"><i class="icon icon-remove"></i></a>
			  	</div>
			  	<div>{{ n.date }}</div>
			  	<div><b>{{n.sender.nickname}}</b> favorited your artwork</div>
			  	{% if not n.artwork %}
			  	<div>Image or comment was deleted</div>
		  		{% else %}	
				<h2><a href="/images/details/{{ n.artwork.key.id }}">{{ n.artwork.name }}</a></h2>
				{% endif %}
			</div>
		</div>
	  {% endif %}
	{% endfor %}
</div>

<div class="empty-page-message" style="display:none;">
	There are no notifications for you
</div>

</div>

 
</div>

<script>
var notificationCount={{ notificationCount }};

$(function() {
	$(".btn-delete-notification").click(
		function() {
			var notificationId=$(this).attr("notification_id");
			$.get("/delete-notification?id="+notificationId,
				function() {
					$("#row-"+notificationId).slideUp();	
					$("#icon-"+notificationId).slideUp();
					
					notificationCount--;
					if (notificationCount==0) {
						$('.empty-page-message').fadeIn();
					}
				});
		});
		
	if (notificationCount==0) {
		$('.empty-page-message').show();
	}
});
</script>
{% endblock content %}


